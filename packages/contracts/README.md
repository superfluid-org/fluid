## Address Registry :

Latest deployed contract address

### BASE MAINNET - RC Deployment :

| Contract                        | Address                                    | Explorer                                                                |
| ------------------------------- | ------------------------------------------ | ----------------------------------------------------------------------- |
| FluidToken (SuperToken)         | 0xa69f80524381275A7fFdb3AE01c54150644c8792 | https://basescan.org/address/0x1547A1FeBE691cE721FD3F60e94e444d60d6f716 |
| FluidEPProgramManager (Logic)   | 0xee117cD6F04FB85c5bb1bBeB59Bf1F9E16E05764 | https://basescan.org/address/0xee117cD6F04FB85c5bb1bBeB59Bf1F9E16E05764 |
| FluidEPProgramManager (Proxy)   | 0x1e32cf099992E9D3b17eDdDFFfeb2D07AED95C6a | https://basescan.org/address/0x1e32cf099992E9D3b17eDdDFFfeb2D07AED95C6a |
| StakingRewardController (Logic) | 0x4f69302E435f6D6c9eD40719098B13265027D8C2 | https://basescan.org/address/0x4f69302E435f6D6c9eD40719098B13265027D8C2 |
| StakingRewardController (Proxy) | 0xb19Ae25A98d352B36CED60F93db926247535048b | https://basescan.org/address/0xb19Ae25A98d352B36CED60F93db926247535048b |
| FluidLocker (Logic)             | 0x939659D22aC378426EdF5e71Fc9bD5B89065F8A4 | https://basescan.org/address/0x939659D22aC378426EdF5e71Fc9bD5B89065F8A4 |
| FluidLocker (Beacon)            | 0x664161f0974F5B17FB1fD3FDcE5D1679E829176c | https://basescan.org/address/0x664161f0974F5B17FB1fD3FDcE5D1679E829176c |
| Fontaine (Logic)                | 0xbFe2ceE2Cc266f26Aaf434Ef69e390FC2a0033fA | https://basescan.org/address/0xbFe2ceE2Cc266f26Aaf434Ef69e390FC2a0033fA |
| Fontaine (Beacon)               | 0xA26FbA47Da24F7DF11b3E4CF60Dcf7D1691Ae47d | https://basescan.org/address/0xA26FbA47Da24F7DF11b3E4CF60Dcf7D1691Ae47d |
| FluidLockerFactory (Logic)      | 0xf6EED68979870941AEF88914534F67d06Ae15B80 | https://basescan.org/address/0xf6EED68979870941AEF88914534F67d06Ae15B80 |
| FluidLockerFactory (Proxy)      | 0xA6694cAB43713287F7735dADc940b555db9d39D9 | https://basescan.org/address/0xA6694cAB43713287F7735dADc940b555db9d39D9 |

### BASE MAINNET - Preliminary Deployment :

| Contract                        | Address                                    | Explorer                                                                |
| ------------------------------- | ------------------------------------------ | ----------------------------------------------------------------------- |
| FluidToken (SuperToken)         | 0x1547A1FeBE691cE721FD3F60e94e444d60d6f716 | https://basescan.org/address/0x1547A1FeBE691cE721FD3F60e94e444d60d6f716 |
| FluidEPProgramManager (Logic)   | 0xAdb88e0197FA97DD3dACdd3F46f2abB1B5EF1ABf | https://basescan.org/address/0xAdb88e0197FA97DD3dACdd3F46f2abB1B5EF1ABf |
| FluidEPProgramManager (Proxy)   | 0x9385751199E73D89cd3d105D06a6Dc61882Fbf00 | https://basescan.org/address/0x9385751199E73D89cd3d105D06a6Dc61882Fbf00 |
| StakingRewardController (Logic) | 0xc9c40Ee9a27768ceb7AEc9690a13111797AD1d68 | https://basescan.org/address/0xc9c40Ee9a27768ceb7AEc9690a13111797AD1d68 |
| StakingRewardController (Proxy) | 0xf0Ba0166B9823736120b775bdaEfDd60A863635d | https://basescan.org/address/0xf0Ba0166B9823736120b775bdaEfDd60A863635d |
| FluidLocker (Logic)             | 0xFb1d096873bbeC298F2FbEAC42394C5cb92973c2 | https://basescan.org/address/0xFb1d096873bbeC298F2FbEAC42394C5cb92973c2 |
| FluidLocker (Beacon)            | 0xffCdA4caB812e10Fd8c89AE56fA88Ce9660f688B | https://basescan.org/address/0xffCdA4caB812e10Fd8c89AE56fA88Ce9660f688B |
| Fontaine (Logic)                | 0x28D5c31FD29f1baCa7197Da48Fd1a6d0e0f460a8 | https://basescan.org/address/0x28D5c31FD29f1baCa7197Da48Fd1a6d0e0f460a8 |
| Fontaine (Beacon)               | 0x1f6f372ebd7A50C6D4070a1501fac24B8DF0dd61 | https://basescan.org/address/0x1f6f372ebd7A50C6D4070a1501fac24B8DF0dd61 |
| FluidLockerFactory (Logic)      | 0x38841b2D2386C3f7ca4585f2efb9E79b37726ad4 | https://basescan.org/address/0x38841b2D2386C3f7ca4585f2efb9E79b37726ad4 |
| FluidLockerFactory (Proxy)      | 0x25963B2502F895D7d0953D147da97CCD12225380 | https://basescan.org/address/0x25963B2502F895D7d0953D147da97CCD12225380 |

### ETHEREUM SEPOLIA :

| Contract           | Address                                    | Explorer                                                                        |
| ------------------ | ------------------------------------------ | ------------------------------------------------------------------------------- |
| FluidToken (ERC20) | 0xe1F66A06c08911203e093303Eb9Ff07EdbFFe030 | https://sepolia.etherscan.io/address/0xe1F66A06c08911203e093303Eb9Ff07EdbFFe030 |

### BASE SEPOLIA :

| Contract                        | Address                                    | Explorer                                                                        |
| ------------------------------- | ------------------------------------------ | ------------------------------------------------------------------------------- |
| FluidToken (SuperToken)         | 0xFd62b398DD8a233ad37156690631fb9515059d6A | https://sepolia.basescan.org/address/0xFd62b398DD8a233ad37156690631fb9515059d6A |
| FluidEPProgramManager (Logic)   | 0x52ca22b0cC23b0f6977A71bC27215a168545BDE4 | https://sepolia.basescan.org/address/0x52ca22b0cC23b0f6977A71bC27215a168545BDE4 |
| FluidEPProgramManager (Proxy)   | 0x71a1975A1009e48E0BF2f621B6835db5Ea1f7706 | https://sepolia.basescan.org/address/0x71a1975A1009e48E0BF2f621B6835db5Ea1f7706 |
| StakingRewardController (Logic) | 0x28F0BC53b52208c8286A4C663680C2eD99d18982 | https://sepolia.basescan.org/address/0x28F0BC53b52208c8286A4C663680C2eD99d18982 |
| StakingRewardController (Proxy) | 0x9FC0Bb109F3e733Bd84B30F8D89685b0304fC018 | https://sepolia.basescan.org/address/0x9FC0Bb109F3e733Bd84B30F8D89685b0304fC018 |
| FluidLocker (Logic)             | 0x51095e6543b80ADa11766D8bD63dE1F4Ce7209fC | https://sepolia.basescan.org/address/0x51095e6543b80ADa11766D8bD63dE1F4Ce7209fC |
| FluidLocker (Beacon)            | 0xf2880c6D68080393C1784f978417a96ab4f37c38 | https://sepolia.basescan.org/address/0xf2880c6D68080393C1784f978417a96ab4f37c38 |
| Fontaine (Logic)                | 0x360FD6B9395c0f3A5FFd0Cc8bc00E5c4C159591c | https://sepolia.basescan.org/address/0x360FD6B9395c0f3A5FFd0Cc8bc00E5c4C159591c |
| Fontaine (Beacon)               | 0xeBfA246A0BAd08A2A3ffB137ed75601AA41867dE | https://sepolia.basescan.org/address/0xeBfA246A0BAd08A2A3ffB137ed75601AA41867dE |
| FluidLockerFactory (Logic)      | 0x600750b3D8bf754E72aDE2738aFBe4189281B8B0 | https://sepolia.basescan.org/address/0x4Fd60B2F8486459a3aa5a7F73178CCE7AA1A58BD |
| FluidLockerFactory (Proxy)      | 0x897D343D24Ac5b84838B976Cf37036EDEfe3E967 | https://sepolia.basescan.org/address/0x897D343D24Ac5b84838B976Cf37036EDEfe3E967 |

## Test Coverage :

Current test coverage is as follow :

| File                                     | % Lines             | % Statements       | % Branches        | % Funcs           |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/EPProgramManager.sol                 | 100.00% (55/55)     | 100.00% (56/56)    | 100.00% (14/14)   | 100.00% (13/13)   |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/FluidEPProgramManager.sol            | 95.74% (90/94)      | 98.00% (98/100)    | 100.00% (20/20)   | 86.67% (13/15)    |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/FluidLocker.sol                      | 100.00% (100/100)   | 98.04% (100/102)   | 87.50% (14/16)    | 100.00% (21/21)   |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/FluidLockerFactory.sol               | 83.87% (26/31)      | 80.95% (17/21)     | 0.00% (0/2)       | 81.82% (9/11)     |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/Fontaine.sol                         | 100.00% (25/25)     | 96.00% (24/25)     | 80.00% (4/5)      | 100.00% (3/3)     |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/StakingRewardController.sol          | 91.67% (22/24)      | 94.44% (17/18)     | 100.00% (3/3)     | 87.50% (7/8)      |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/TreasuryGadget.sol                   | 100.00% (18/18)     | 100.00% (12/12)    | 100.00% (2/2)     | 100.00% (6/6)     |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/token/BridgedSuperToken.sol          | 98.48% (65/66)      | 98.46% (64/65)     | 90.00% (9/10)     | 100.00% (13/13)   |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/token/FluidToken.sol                 | 0.00% (0/6)         | 0.00% (0/4)        | 100.00% (0/0)     | 0.00% (0/3)       |
| ---------------------------------------- | ------------------- | ------------------ | ----------------- | ----------------- |
| src/token/OPBridgedSuperToken.sol        | 71.43% (10/14)      | 84.62% (11/13)     | 100.00% (0/0)     | 66.67% (4/6)      |

## Deployment Procedure

### Step 1 - ETH Mainnet Token Deployment

```shell
OWNER={DEPLOYER_ADDRESS} \
INITIAL_SUPPLY=1000000000000000000000000000 \
forge script script/token/DeploySupToken.s.sol:DeployL1SupToken --ffi --rpc-url ${ETH_MAINNET_RPC_URL} --broadcast -vvv --verify --etherscan-api-key ${ETHERSCAN_API_KEY}
```

### Step 2 - Transfer 650M $SUP to Foundation Multisig (L1)

> NOTE : `transfer(address,uint256) args : sender, amount`

```shell
cast send --rpc-url {ETH_MAINNET_RPC_URL} {L1_FLUID_TOKEN_ADDRESS} "transfer(address,uint256)" {FOUNDATION_MULTISIG_ADDRESS} 650000000000000000000000000 --private-key $PRIVATE_KEY
```

### Step 3 - Base Token Deployment

```shell
OWNER={FOUNDATION_MULTISIG_ADDRESS} \
INITIAL_SUPPLY=0 \
REMOTE_TOKEN={L1_FLUID_TOKEN_ADDRESS} \
NATIVE_BRIDGE={NATIVE_BRIDGE} \
SUPERTOKEN_FACTORY={BASE_MAINNET_SUPERTOKEN_FACTORY} \
forge script script/DeployFluidToken.s.sol:DeployOPFluidSuperToken --ffi --rpc-url {BASE_MAINNET_RPC_URL} --broadcast -vvv
```

### Step 4 - Bridge 350M $FLUID to Base ($FLUID on L1 -> $FLUIDx on Base L2)

#### Approve the bridge contract

> NOTE : `approve(address,uint256) args : spender, allowance`

```shell
cast send --rpc-url $ETH_MAINNET_RPC_URL {L1_FLUID_TOKEN_ADDRESS} "approve(address,uint256)" {L1_BRIDGE_ADDRESS} 350000000000000000000000000 --private-key $PRIVATE_KEY
```

#### Bridge the tokens

> NOTE : `bridgeERC20(address,address,uint256,uint32,bytes) args : tokenAddressL1, tokenAddressL2, amount, gasLimit, data`

```shell
cast send --rpc-url $ETH_MAINNET_RPC_URL {L1_BRIDGE_ADDRESS} "bridgeERC20(address,address,uint256,uint32,bytes)" {L1_FLUID_TOKEN_ADDRESS} {L2_FLUID_TOKEN_ADDRESS} 350000000000000000000000000 10000000 0x --private-key $PRIVATE_KEY
```

### Step 5 - Transfer 350M $FLUID to Community Multisig (L2)

> NOTE : `transfer(address,uint256) args : sender, amount`

```shell
cast send --rpc-url $BASE_MAINNET_RPC_URL {L2_FLUID_TOKEN_ADDRESS} "transfer(address,uint256)" {COMMUNITY_MULTISIG_ADDRESS} 350000000000000000000000000 --private-key $PRIVATE_KEY
```

### Step 6 - Locker Contract System Deployment

```shell
FLUID_ADDRESS={L2_FLUID_TOKEN_ADDRESS} \
GOVERNOR_ADDRESS={COMMUNITY_MULTISIG_ADDRESS} \
TREASURY_ADDRESS={COMMUNITY_MULTISIG_ADDRESS} \
PAUSE_FACTORY_LOCKER_CREATION=false \
FLUID_UNLOCK_STATUS=true \
forge script script/Deploy.s.sol:DeployScript --ffi --rpc-url $BASE_MAINNET_RPC_URL --broadcast -vvv
```

### References

```
HOST_ADDRESS : Superfluid Host address
FLUID_ADDRESS : SuperToken to be distributed
GOVERNOR_ADDRESS : Contract owner address
TREASURY_ADDRESS : Treasury address holding the SuperToken to be distributed
STACK_SIGNER_ADDRESS : Signer address to be verified in order to grant units
PAUSE_FACTORY_LOCKER_CREATION : Whether the Factory allows Lockers to be created or not
FLUID_UNLOCK_STATUS : Whether the Lockers allow the SuperToken to be withdrawn or not
```

## SUP Vesting Operational Guidelines

### Pre-requisite

- Have an ADMIN account created
- Have the TREASURY multisig create and setup
- Have all the insiders data ready and validated :
  - `recipient` address
  - `amount` for each insider
  - vesting parameter (`cliffAmount` / `cliffDate` / `endDate`)

### Step 1 :

- Deploy the `SupVestingFactory` contract

- Note 1 : In `DeployVesting.s.sol` script, we deploy a dummy `SupVesting` contract for verification purpose.
  This might not be need if we perform a preliminary mainnet deployment

- Note 2 : Once the `SupVestingFactory` contract is deployed, the SNAPSHOT STRATEGY parameters must be updated.

```shell
/*
SUP_ADDRESS={SUP_ADDRESS} \
VESTING_SCHEDULER_ADDRESS={VESTING_SCHEDULER_ADDRESS} \
ADMIN_ADDRESS={ADMIN_ADDRESS} \
TREASURY_ADDRESS={TREASURY_ADDRESS} \
forge script script/vesting/DeployVesting.s.sol:DeployVestingScript --ffi --rpc-url $BASE_MAINNET_RPC_URL --broadcast --verify -vvv --etherscan-api-key $BASESCAN_API_KEY
*/
```

### Step 2 :

- Approve the `SupVestingFactory` contract address to spend $SUP tokens from the Treasury Multisig
- Note : Approved Amount = sum of all insiders' amount

### Step 3 :

- Execute script to create SupVesting contract for each insiders.
- Note : Currently, the `SupVestingFactory` contract allows prefunding of the `SupVesting` contracts.
  We must remain consistent and either prefund or not prefund every `SupVesting` contracts.

### Step 4 :

- Add each `SupVesting` contract address to the automation whitelist (offchain)

### Step 5 :

- Update `SupVestingFactory` admin account (`SupVestingFactory::setAdmin`) to TREASURY multisig
